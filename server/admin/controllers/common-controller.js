const catchAsync = require('../../utils/catch-async');
const AppError = require('../../utils/app-error-handler');
// const APIFeatures = require('../../utils/api-features');
// const AppConfig = require('../models/app-config-model');
const Companies = require('../../company/models/company');
const CompanyUser = require('../../company/models/company-user');
const Positions = require('../../company/models/positions');
const Talents = require('../../talent/models/talent-model');


exports.deleteAutoGeneratedRecords = catchAsync(async (req, res, next) => {
  let recordType = req.body.type;

  if (recordType == 'talent') {
    let deletedTalents = await Talents.deleteMany(
      { "isAutoGenerate": true }
    );
  }
  if (recordType == 'company') {
    let deletedCompanies = await Companies.deleteMany(
      { "isAutoGenerate": true }
    );

  }
  if (recordType == 'company-user') {
    let deletedCompanyUsers = await CompanyUser.deleteMany(
      { "isAutoGenerate": true }
    );

  }
  if (recordType == 'position') {
    let deletedPositions = await Positions.deleteMany(
      { "isAutoGenerate": true }
    );
  } else {
    return next(new AppError("Type must be 'talent','company','company-user' or 'position' .", 400));
  }


  res.status(202).json({
    status: 'success',
    message: "Records deleted Successfully!"
  });

});
